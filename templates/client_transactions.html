{% extends "base.html" %}

{% block title %}Transactions for {{ client.client_name }} - Ledger System{% endblock %}

{% block content %}
<div class="page-header">
    <h2>Transactions for {{ client.client_name }}</h2>
    <a href="{{ url_for('clients') }}" class="btn btn-secondary">Back to Clients</a>
</div>

{% if transactions %}
<!-- Desktop Table View -->
<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>S.No</th>
                <th>ID</th>
                <th>Applicant Name</th>
                <th>App ID</th>
                <th>Country</th>
                <th>Country Price</th>
                <th>Rate</th>
                <th>Addition</th>
                <th>Amount</th>
                <th>Amount N</th>
                <th>Email/Link</th>
                <th>Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ transaction.id }}</td>
                <td>{{ transaction.applicant_name }}</td>
                <td>{{ transaction.app_id }}</td>
                <td>{{ transaction.country_name }}</td>
                <td>{{ "%.2f"|format(transaction.country_price) }}</td>
                <td>{{ "%.2f"|format(transaction.rate) }}</td>
                <td>{{ "%.2f"|format(transaction.addition) }}</td>
                <td>{{ "%.2f"|format(transaction.amount) }}</td>
                <td><strong>{{ "%.2f"|format(transaction.amount_n) }}</strong></td>
                <td>{{ transaction.transaction_date }}</td>
                <td>
                    <a href="{{ url_for('edit_transaction', transaction_id=transaction.id) }}" class="btn btn-secondary btn-sm">Edit</a>
                    <form action="{{ url_for('delete_transaction', transaction_id=transaction.id) }}" 
                          method="POST" 
                          style="display: inline;"
                          onsubmit="return confirm('Are you sure you want to delete this transaction?');">
                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Mobile Card View -->
<div class="mobile-card-view">
    {% for transaction in transactions %}
    <div class="mobile-card">
        <div class="mobile-card-header">#{{ loop.index }} - Transaction #{{ transaction.id }}</div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Applicant Name:</span>
            <span class="mobile-card-value">{{ transaction.applicant_name }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">App ID:</span>
            <span class="mobile-card-value">{{ transaction.app_id }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Country:</span>
            <span class="mobile-card-value">{{ transaction.country_name }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Country Price:</span>
            <span class="mobile-card-value">{{ "%.2f"|format(transaction.country_price) }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Rate:</span>
            <span class="mobile-card-value">{{ "%.2f"|format(transaction.rate) }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Addition:</span>
            <span class="mobile-card-value">{{ "%.2f"|format(transaction.addition) }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Amount:</span>
            <span class="mobile-card-value">{{ "%.2f"|format(transaction.amount) }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Amount N:</span>
            <span class="mobile-card-value"><strong>{{ "%.2f"|format(transaction.amount_n) }}</strong></span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Email/Link:</span>
            <span class="mobile-card-value">{{ transaction.email_link or '' }}</span>
        </div>
        <div class="mobile-card-row">
            <span class="mobile-card-label">Date:</span>
            <span class="mobile-card-value">{{ transaction.transaction_date }}</span>
        </div>
        <div class="mobile-card-actions">
            <a href="{{ url_for('edit_transaction', transaction_id=transaction.id) }}" class="btn btn-secondary btn-sm">Edit</a>
            <form action="{{ url_for('delete_transaction', transaction_id=transaction.id) }}" 
                  method="POST" 
                  style="display: inline; flex: 1;"
                  onsubmit="return confirm('Are you sure you want to delete this transaction?');">
                <button type="submit" class="btn btn-danger btn-sm" style="width: 100%;">Delete</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<p class="empty-state">No transactions for this client yet.</p>
{% endif %}
{% endblock %}
